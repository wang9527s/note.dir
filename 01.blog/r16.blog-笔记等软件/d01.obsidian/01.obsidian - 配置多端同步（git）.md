
> 看到git同步的时候，一开始很开心，打算本地部署一个server(安全可靠)，然后无感使用。后面发现ios上比较麻烦，最后选怎了不使用git插件，直接使用git命令

### 1、wsl 端的环境部署 （server）

+ 添加windows上git密钥

```bash
# 追加windows上 ~/.ssh/id_rsa.pub中的内容到 ~/.ssh/authorized_keys 中
echo "ssh-rsa AAA202@qq.com" >> ~/.ssh/authorized_keys

# emm 权限不要更改
# SSH 出于安全考虑，会拒绝使用权限过宽的授权密钥文件。
chmod 600 ~/.ssh/id_rsa
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

使用ssh username@ip 可以进行测试，如果不需要密码，则密钥配置成功

+ 仓库初始化

server的初始化，需要使用裸仓库。```git init --bare obsidian.dir```

### 2、windows 

  obsidian创建目录A
  
  使用git bash进入A中，执行如下命令

```bash
git init
git remote add origin username@172.27.93.12:/home/username/obsidian.git
```

  使用obsidian文件编辑，然后命令行进行commit、push、pull操作

### 3、ios

  iso上的obsidian的git插件作用不大。使用iSH进行配置

#### iSH配置
  
**安装必要软件**

```bash
apk update
apk add git vim openssh openrc
```

**配置git环境**

```bash
# 然后添加公钥到对应的remote端，github或者wsl环境中等。
# wsl参考第一部分内容
```

**配置ssh**

```bash
# 修改/etc/ssh/sshd_config中的内容，为PermitRootLogin yes
# 然后重启ssh服务
rc-service sshd restart
```

**关联远端仓库**

```bash
cd obsidian.git
git config --global --add safe.directory /root/obsidian.git
git remote add origin ssh://wangbin@192.168.0.102:/home/.../obsidian.git

git pull --rebase origin master
```

然后push/pull中操作，需要在iSH中进行

#### 分享iSH中的文件给其它应用
  
  挂在文件app中的文件（共享文件）到iSH中

```bash
# 执行下面这个命令后，在弹出的界面中选择文件夹，即可将对应的目录挂在到obsidian中
mount -t ios . obsidian

# umount obsidian 解除obsidian的挂载
```