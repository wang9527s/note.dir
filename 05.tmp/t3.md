obsidian 图片插件
    https://forum-zh.obsidian.md/t/topic/44910/2

```py
import sys
from datetime import datetime, timedelta
import time
import pyautogui
import subprocess
import os

def ms2str(timestamp_ms):
    timestamp_sec = timestamp_ms / 1000.0

    # 转换为 UTC 时间
    dt_utc = datetime.utcfromtimestamp(timestamp_sec)
    # 北京时间为 UTC+8
    dt_bj = dt_utc + timedelta(hours=8)
    dt_bj_str = dt_bj.strftime('%Y-%m-%d %H:%M:%S') + f".{int(timestamp_ms) % 1000:03}"
    return dt_bj_str

def str2ms(tm_str):
    time_obj = datetime.strptime(tm_str, "%Y-%m-%d %H:%M:%S.%f")
    return time_obj.timestamp()

def win_bt_control_ui(enable:bool, extra=None):
    if enable == is_bluetooth_enabled():
        return True

    os.system("start ms-settings:bluetooth")
    time.sleep(0.8)
    # 定位开关并操作
    pyautogui.hotkey('shift', 'tab')
    pyautogui.press('tab')
    pyautogui.press('space')  #  切换开关状态

    try_count = 5
    while try_count:
        try_count-=1
        time.sleep(1)
        if enable == is_bluetooth_enabled():
            return True

    return False

def win_wifi_control_ui(enable:bool, extra=None):
    if enable == is_wifi_enabled():
        return True

    os.system("start ms-settings:network-wifi")
    time.sleep(0.8)
    # 定位开关并操作
    pyautogui.hotkey('shift', 'tab')
    pyautogui.press('tab')
    pyautogui.press('tab')
    pyautogui.press('space')  #  切换开关状态
    try_count = 5
    while try_count:
        try_count-=1
        time.sleep(1)
        if enable == is_wifi_enabled():
            return True

    return False

def is_bluetooth_enabled() -> bool:
    # _.FriendlyName -match 'Bluetooth Device' -and $_.Status -eq 'OK' 这里的判断再其他机器上可能失效
    command = (
        "Get-PnpDevice -Class Bluetooth | "
        "Where-Object { $_.FriendlyName -match 'Bluetooth Device' -and $_.Status -eq 'OK' } | "
        "Measure-Object | "
        "Select-Object -ExpandProperty Count"
    )

    result = subprocess.run(
        ["powershell", "-Command", command],
        capture_output=True,
        text=True
    )

    try:
        return int(result.stdout.strip()) > 0
    except ValueError:
        return False


def is_wifi_enabled():
    # 同上，判断在其他机器上可能失效
    command = " Get-NetAdapter -ErrorAction SilentlyContinue | Where-Object { $_.InterfaceType -eq 71 } | Select-Object -First 1 -ExpandProperty Status"
    result = subprocess.run(["powershell", "-Command", command], capture_output=True, text=True)
    return 'Up' == result.stdout.strip()

def test():
    origin = 1770036533554
    print(f"origin is {origin}")
    tm_str = ms2str(origin)
    print(f"tm_str {tm_str}")
    tm = str2ms(tm_str)
    print(f"tm {tm}")

    win_bt_control_ui(False)
    win_bt_control_ui(True)
    win_wifi_control_ui(False)
    win_wifi_control_ui(True)

test()
```